---
phase: 01-foundation
plan: 02
type: execute
wave: 2
depends_on: ["01-01"]
files_modified: [src/models/database.py, src/models/deck.py, src/models/flashcard.py]
autonomous: true
---

<objective>
Create SQLite database schema for storing flashcard decks and individual flashcards.

Purpose: Establish data models that organize flashcards into topic-based decks, enabling structured storage and retrieval for study sessions.
Output: Database initialization code and model classes for Deck and Flashcard tables.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/01-foundation/01-01-SUMMARY.md

# Project requirements context:
# - Local SQLite database (no server needed)
# - Organize flashcards into decks by topic name
# - Store question-answer pairs
# - Track study statistics (count, success rate, timestamp, streak)
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create database initialization module</name>
  <files>src/models/database.py</files>
  <action>Create database.py with SQLite connection helper. Define get_db() function that returns connection to 'flashcards.db' in project root. Define init_db() function that creates tables if they don't exist. Use sqlite3 standard library (no ORM - keeping it simple for learning). Include SQL CREATE TABLE statements for decks and flashcards tables. Set up foreign key constraints (deck_id references decks.id). Use TEXT for strings, INTEGER for IDs, REAL for timestamps (Unix epoch).</action>
  <verify>python -c "from src.models.database import get_db, init_db; init_db()" creates flashcards.db</verify>
  <done>database.py exports get_db() and init_db(), creates tables on init</done>
</task>

<task type="auto">
  <name>Task 2: Create Deck model</name>
  <files>src/models/deck.py</files>
  <action>Create deck.py with Deck class containing helper methods for CRUD operations. Schema: id (INTEGER PRIMARY KEY), name (TEXT NOT NULL UNIQUE - topic name), created_at (REAL - Unix timestamp). Methods: create(name), get_by_id(id), get_all(), delete(id). Use raw SQL with sqlite3 cursor, no ORM. Return dicts from queries for simplicity.</action>
  <verify>python -c "from src.models.deck import Deck; Deck.create('Test Deck')" succeeds</verify>
  <done>Deck model with CRUD methods, returns dict representations</done>
</task>

<task type="auto">
  <name>Task 3: Create Flashcard model</name>
  <files>src/models/flashcard.py</files>
  <action>Create flashcard.py with Flashcard class. Schema: id (INTEGER PRIMARY KEY), deck_id (INTEGER NOT NULL - FOREIGN KEY to decks.id), question (TEXT NOT NULL), answer (TEXT NOT NULL), created_at (REAL), studied_count (INTEGER DEFAULT 0), success_count (INTEGER DEFAULT 0), last_studied (REAL), streak (INTEGER DEFAULT 0). Methods: create(deck_id, question, answer), get_by_deck(deck_id), update_stats(id, success), delete(id). Include ON DELETE CASCADE for deck_id foreign key.</action>
  <verify>python -c "from src.models.flashcard import Flashcard; from src.models.deck import Deck; d=Deck.create('Test'); Flashcard.create(d['id'], 'Q?', 'A')" succeeds</verify>
  <done>Flashcard model with CRUD and statistics tracking methods</done>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] database.py creates flashcards.db with both tables
- [ ] Deck model CRUD operations work (create, get, delete)
- [ ] Flashcard model CRUD operations work with foreign key to decks
- [ ] Statistics fields (studied_count, success_count, last_studied, streak) present
- [ ] Foreign key constraint enforced (deleting deck cascades to flashcards)
- [ ] No SQL injection vulnerabilities (use parameterized queries)
</verification>

<success_criteria>

- All tasks completed
- Database schema matches requirements (decks, flashcards tables)
- Models provide clean dict-based interface (no ORM complexity)
- Statistics tracking fields ready for Phase 6
- Foreign key relationships properly defined
- No security issues (parameterized SQL only)
</success_criteria>

<output>
After completion, create `.planning/phases/01-foundation/01-02-SUMMARY.md`
</output>
