---
phase: 06-deck-management
plan: 01
type: execute
wave: 1
depends_on: []
files_modified: [src/routes/main.py, src/templates/decks.html, src/templates/preview.html]
autonomous: false
---

<objective>
Add delete functionality for decks and individual flashcards.

Purpose: Allow users to remove unwanted decks or cards from their library.
Output: Working delete buttons with confirmation dialogs.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
@~/.claude/get-shit-done/references/checkpoints.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md

# Existing models with delete methods already implemented
@src/models/deck.py
@src/models/flashcard.py

# Templates to add delete buttons
@src/templates/decks.html
@src/templates/preview.html

# Routes to add delete endpoints
@src/routes/main.py
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add deck delete endpoint and UI</name>
  <files>src/routes/main.py, src/templates/decks.html</files>
  <action>
**Add DELETE endpoint in main.py:**
Create `POST /deck/<int:deck_id>/delete` route that:
1. Calls `Deck.delete(deck_id)` (CASCADE deletes all flashcards)
2. Returns redirect to `/decks` on success
3. Returns 404 if deck not found

**Add delete button in decks.html:**
1. Add a red "Delete" button next to "Study Now" button for each deck
2. Use JavaScript `confirm()` dialog: "Delete '{deck.name}' and all its cards? This cannot be undone."
3. If confirmed, submit form POST to `/deck/{deck_id}/delete`
4. Style: `bg-red-600 hover:bg-red-700 text-white` button

**Button layout:** Study Now (green) on left, Delete (red) on right, in a flex container.
  </action>
  <verify>
1. Navigate to /decks
2. Click Delete on a deck
3. Confirm dialog appears with deck name
4. After confirm, deck disappears from list
5. Refresh page - deck is gone
  </verify>
  <done>Decks can be deleted with confirmation dialog. CASCADE deletes all flashcards.</done>
</task>

<task type="auto">
  <name>Task 2: Add individual card delete functionality</name>
  <files>src/routes/main.py, src/templates/preview.html</files>
  <action>
**Add DELETE endpoint in main.py:**
Create `POST /card/<int:card_id>/delete` route that:
1. Calls `Flashcard.delete(card_id)`
2. Returns JSON `{'success': true}` on success
3. Returns 404 JSON error if card not found

**Add delete button in preview.html:**
1. Add a small "×" or trash icon button in top-right corner of each card
2. Use JavaScript `confirm()`: "Delete this flashcard?"
3. On confirm, send POST to `/card/{card_id}/delete`
4. On success, remove the card element from DOM without page reload
5. Update card count display if visible

**Style:** Small red text "×" or outline red button, positioned absolute in card corner.
  </action>
  <verify>
1. Generate a new deck or view existing preview
2. Click delete on a card
3. Confirm dialog appears
4. Card disappears from preview
5. Card count updates (if displayed)
  </verify>
  <done>Individual flashcards can be deleted from preview page.</done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <what-built>Delete functionality for decks and individual flashcards</what-built>
  <how-to-verify>
1. Run Flask: `cd ~/Expanza_Gary_Test && FLASK_APP=src.app flask run --port 5001`
2. Visit http://localhost:5001/decks
3. **Test deck deletion:**
   - Click "Delete" on any deck
   - Confirm the dialog shows deck name
   - After confirm, deck should disappear
   - Refresh - deck should stay deleted
4. **Test card deletion:**
   - Go to homepage, generate a new deck with notes
   - On preview page, click "×" on a card
   - Card should disappear without page reload
5. **Verify CASCADE:**
   - Note the card count of a deck
   - Delete the entire deck
   - Verify flashcards table doesn't have orphaned cards
  </how-to-verify>
  <resume-signal>Type "approved" to continue, or describe any issues to fix</resume-signal>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] Flask app runs without errors
- [ ] Decks can be deleted with confirmation
- [ ] Individual cards can be deleted from preview
- [ ] CASCADE delete works (no orphaned flashcards)
- [ ] Human verification passed
</verification>

<success_criteria>

- All tasks completed
- Delete operations work with confirmation dialogs
- No data integrity issues
- User approved functionality
</success_criteria>

<output>
After completion, create `.planning/phases/06-deck-management/06-01-SUMMARY.md`
</output>
